<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QuickInvoice - Professional PDF Invoices</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {}
      }
    }
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body class="bg-gradient-to-br from-orange-50 via-amber-50 to-yellow-50 dark:from-slate-900 dark:via-gray-900 dark:to-slate-900 min-h-screen transition-colors duration-300">
  <!-- Header -->
  <header class="bg-white/80 dark:bg-slate-900/80 backdrop-blur-md shadow-2xl border-b border-orange-200 dark:border-slate-700 sticky top-0 z-50">
    <div class="max-w-4xl mx-auto px-4 py-6 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center">
        <h1 class="text-4xl sm:text-5xl font-black bg-gradient-to-r from-orange-600 via-amber-600 to-yellow-600 bg-clip-text text-transparent drop-shadow-lg">ğŸ§¾ QuickInvoice</h1>
        <button id="theme-toggle" class="p-3 rounded-2xl bg-slate-200 dark:bg-slate-700 hover:bg-slate-300 dark:hover:bg-slate-600 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-110 active:scale-95">
          <span class="dark:hidden">ğŸŒ™</span>
          <span class="hidden dark:inline">â˜€ï¸</span>
        </button>
      </div>
    </div>
  </header>
  <main class="max-w-4xl mx-auto px-4 py-16 sm:px-6 lg:px-8 space-y-12">
    <!-- Pro Card -->
    <div class="bg-white/60 dark:bg-slate-800/60 backdrop-blur-xl rounded-3xl shadow-2xl p-10 text-center hover:shadow-3xl transition-all duration-500 animate-in slide-in-from-top-4 fade-in">
      <h2 class="text-3xl font-bold mb-6 bg-gradient-to-r from-orange-600 to-amber-600 bg-clip-text text-transparent">Unlock Pro for $9</h2>
      <p class="text-xl mb-8 text-slate-700 dark:text-slate-300 max-w-2xl mx-auto">One-time payment. Advanced templates, branding, multi-currency, recurring invoices & more.</p>
      <a href="https://quickinvoice.gumroad.com/" target="_blank" class="inline-block bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700 text-white py-6 px-12 rounded-2xl font-bold text-xl shadow-2xl hover:shadow-3xl hover:-translate-y-2 transition-all duration-500">Buy Pro Now â†’</a>
      <p class="mt-6 text-sm text-slate-500 dark:text-slate-400">(Free version is fully functional for basics! ğŸ‰)</p>
    </div>
    <!-- Invoice Form -->
    <div class="bg-white/60 dark:bg-slate-800/60 backdrop-blur-xl rounded-3xl shadow-2xl p-10 hover:shadow-3xl transition-all duration-500 animate-in slide-in-from-bottom-4 fade-in">
      <form id="invoiceForm" class="space-y-8">
        <!-- Business Info -->
        <div class="grid md:grid-cols-2 gap-8">
          <div>
            <label class="block text-xl font-bold mb-4 text-slate-900 dark:text-white">ğŸ¢ Your Business</label>
            <input type="text" id="bizName" value="Your Freelance Biz" class="w-full p-6 border-2 border-slate-200 dark:border-slate-600 rounded-2xl focus:ring-4 focus:ring-orange-500/50 focus:border-orange-500 bg-white dark:bg-slate-700 text-lg shadow-xl transition-all duration-300" required>
            <textarea id="bizAddress" rows="3" class="w-full mt-4 p-6 border-2 border-slate-200 dark:border-slate-600 rounded-2xl focus:ring-4 focus:ring-orange-500/50 focus:border-orange-500 bg-white dark:bg-slate-700 text-lg shadow-xl transition-all duration-300">123 Freelance St
City, State 12345</textarea>
          </div>
          <div>
            <label class="block text-xl font-bold mb-4 text-slate-900 dark:text-white">ğŸ‘¥ Client Info</label>
            <input type="text" id="clientName" value="Client Co." class="w-full p-6 border-2 border-slate-200 dark:border-slate-600 rounded-2xl focus:ring-4 focus:ring-orange-500/50 focus:border-orange-500 bg-white dark:bg-slate-700 text-lg shadow-xl transition-all duration-300" required>
            <textarea id="clientAddress" rows="3" class="w-full mt-4 p-6 border-2 border-slate-200 dark:border-slate-600 rounded-2xl focus:ring-4 focus:ring-orange-500/50 focus:border-orange-500 bg-white dark:bg-slate-700 text-lg shadow-xl transition-all duration-300">456 Client Ave
City, State 67890</textarea>
          </div>
        </div>
        <!-- Invoice Details -->
        <div class="grid md:grid-cols-3 gap-6">
          <div>
            <label class="block text-lg font-semibold mb-3 text-slate-900 dark:text-white">ğŸ“„ Invoice #</label>
            <input type="text" id="invoiceNum" value="INV-001" class="w-full p-5 border-2 border-slate-200 dark:border-slate-600 rounded-xl focus:ring-2 focus:ring-orange-400 bg-white dark:bg-slate-700 text-lg shadow-inner transition-all duration-300">
          </div>
          <div>
            <label class="block text-lg font-semibold mb-3 text-slate-900 dark:text-white">ğŸ“… Invoice Date</label>
            <input type="date" id="invoiceDate" class="w-full p-5 border-2 border-slate-200 dark:border-slate-600 rounded-xl focus:ring-2 focus:ring-orange-400 bg-white dark:bg-slate-700 text-lg shadow-inner transition-all duration-300">
          </div>
          <div>
            <label class="block text-lg font-semibold mb-3 text-slate-900 dark:text-white">â° Due Date</label>
            <input type="date" id="dueDate" class="w-full p-5 border-2 border-slate-200 dark:border-slate-600 rounded-xl focus:ring-2 focus:ring-orange-400 bg-white dark:bg-slate-700 text-lg shadow-inner transition-all duration-300">
          </div>
        </div>
        <!-- Line Items -->
        <div>
          <label class="block text-2xl font-bold mb-6 text-slate-900 dark:text-white">ğŸ›’ Line Items</label>
          <div id="itemsContainer" class="space-y-4 mb-8"></div>
          <button type="button" onclick="addItem()" class="bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white py-4 px-8 rounded-2xl font-bold text-xl shadow-xl hover:shadow-2xl hover:-translate-y-1 transition-all duration-300 mx-auto block">+ Add Item</button>
        </div>
        <!-- Totals -->
        <div class="bg-gradient-to-r from-orange-50 to-amber-50 dark:from-orange-950/30 dark:to-amber-950/30 p-8 rounded-3xl border-2 border-dashed border-orange-200 dark:border-orange-800 shadow-inner">
          <div class="grid md:grid-cols-2 gap-4 text-2xl font-bold text-right md:text-left">
            <div class="text-lg md:text-xl text-slate-700 dark:text-slate-300">Tax Rate (%): <input type="number" id="taxRate" value="0" step="0.1" min="0" class="ml-2 w-24 p-2 border rounded-xl bg-white dark:bg-slate-700 text-lg font-bold text-right"></div>
            <div class="text-lg md:text-xl text-slate-700 dark:text-slate-300">Discount (%): <input type="number" id="discount" value="0" step="0.1" min="0" class="ml-2 w-24 p-2 border rounded-xl bg-white dark:bg-slate-700 text-lg font-bold text-right"></div>
          </div>
          <div class="grid md:grid-cols-2 gap-2 mt-8 text-3xl font-black text-right border-t-4 pt-6 border-orange-300 dark:border-orange-700">
            <div>Subtotal: $<span id="subtotal">0.00</span></div>
            <div class="text-orange-600 dark:text-orange-400">Tax: $<span id="tax">0.00</span></div>
            <div class="-ml-4 text-red-600 dark:text-red-400">Discount: -$<span id="discountAmt">0.00</span></div>
            <div class="border-t-2 pt-4 mt-2 text-4xl bg-gradient-to-r from-orange-600 to-amber-600 bg-clip-text text-transparent">Total: $<span id="total">0.00</span></div>
          </div>
        </div>
        <button type="button" onclick="generatePDF()" class="w-full bg-gradient-to-r from-emerald-500 via-green-500 to-emerald-600 hover:from-emerald-600 hover:via-green-600 hover:to-emerald-700 text-white py-8 rounded-3xl font-black text-2xl shadow-2xl hover:shadow-3xl hover:-translate-y-3 transition-all duration-700 uppercase tracking-wider animate-pulse hover:animate-bounce">ğŸ“„ Generate & Download PDF Invoice</button>
      </form>
    </div>
  </main>
  <script>
    // Theme Toggle (same as above)
    const htmlEl = document.documentElement;
    const toggleBtn = document.getElementById('theme-toggle');
    const setTheme = (isDark) => {
      htmlEl.classList.toggle('dark', isDark);
      toggleBtn.querySelectorAll('span')[0].classList.toggle('hidden', !isDark);
      toggleBtn.querySelectorAll('span')[1].classList.toggle('hidden', isDark);
    };
    if (localStorage.theme === 'dark' || (!localStorage.theme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
      setTheme(true);
    } else {
      setTheme(false);
    }
    toggleBtn.onclick = () => {
      const isDark = htmlEl.classList.contains('dark');
      setTheme(!isDark);
      localStorage.theme = !isDark ? 'dark' : 'light';
    };

    // Init dates
    document.getElementById('invoiceDate').valueAsDate = new Date();
    document.getElementById('dueDate').valueAsDate = new Date(Date.now() + 30 * 24 * 60 * 60 * 1000);

    // Items
    let itemCount = 1;
    const itemsContainer = document.getElementById('itemsContainer');
    function createItemRow() {
      const row = document.createElement('div');
      row.className = 'grid grid-cols-1 md:grid-cols-4 gap-4 p-6 bg-slate-50 dark:bg-slate-800/50 rounded-2xl border-2 border-dashed border-slate-200 dark:border-slate-600 hover:border-orange-400 transition-all duration-300 shadow-inner hover:shadow-md';
      row.innerHTML = `
        <input type="text" placeholder="Description of service/item" class="desc p-4 border rounded-xl focus:ring-2 focus:ring-orange-400 bg-white dark:bg-slate-700 text-lg font-medium col-span-2 md:col-span-2">
        <input type="number" placeholder="Qty" class="qty p-4 border rounded-xl focus:ring-2 focus:ring-orange-400 bg-white dark:bg-slate-700 text-lg font-bold text-right" value="1" min="1">
        <input type="number" placeholder="Rate $" class="rate p-4 border rounded-xl focus:ring-2 focus:ring-orange-400 bg-white dark:bg-slate-700 text-lg font-bold text-right" step="0.01">
        <span class="item-total text-2xl font-black text-orange-600 dark:text-orange-400 text-right self-center">$0.00</span>
      `;
      row.querySelectorAll('input').forEach(input => input.addEventListener('input', updateTotals));
      itemsContainer.appendChild(row);
      updateTotals();
    }
    createItemRow(); // Initial row

    function addItem() {
      itemCount++;
      createItemRow();
    }

    function updateTotals() {
      let subtotal = 0;
      document.querySelectorAll('#itemsContainer > div').forEach(row => {
        const qty = parseFloat(row.querySelector('.qty').value) || 0;
        const rate = parseFloat(row.querySelector('.rate').value) || 0;
        const total = qty * rate;
        row.querySelector('.item-total').textContent = `$${total.toFixed(2)}`;
        subtotal += total;
      });
      const taxRate = parseFloat(document.getElementById('taxRate').value) / 100 || 0;
      const tax = subtotal * taxRate;
      document.getElementById('tax').textContent = tax.toFixed(2);
      const discountRate = parseFloat(document.getElementById('discount').value) / 100 || 0;
      const discountAmt = subtotal * discountRate;
      document.getElementById('discountAmt').textContent = discountAmt.toFixed(2);
      const total = subtotal + tax - discountAmt;
      document.getElementById('subtotal').textContent = subtotal.toFixed(2);
      document.getElementById('total').textContent = total.toFixed(2);
      document.getElementById('taxRate').addEventListener('input', updateTotals);
      document.getElementById('discount').addEventListener('input', updateTotals);
    }

    // PDF Generation (enhanced from original)
    async function generatePDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      const bizName = document.getElementById('bizName').value;
      const bizAddress = document.getElementById('bizAddress').value.replace(/\n/g, '\n');
      const clientName = document.getElementById('clientName').value;
      const clientAddress = document.getElementById('clientAddress').value.replace(/\n/g, '\n');
      const invoiceNum = document.getElementById('invoiceNum').value;
      const invoiceDate = document.getElementById('invoiceDate').value;
      const dueDate = document.getElementById('dueDate').value;

      let y = 20;
      doc.setFontSize(24);
      doc.setFont('helvetica', 'bold');
      doc.text(bizName.toUpperCase(), 20, y);
      y += 15;
      doc.setFontSize(12);
      doc.setFont('helvetica', 'normal');
      const lines = doc.splitTextToSize(bizAddress, 170);
      doc.text(lines, 20, y);
      y += lines.length * 5 + 25;

      doc.setFontSize(16);
      doc.setFont('helvetica', 'bold');
      doc.text(`INVOICE #${invoiceNum}`, 20, y);
      y += 10;
      doc.text(`Date: ${invoiceDate}`, 20, y);
      y += 8;
      doc.text(`Due: ${dueDate}`, 20, y);
      y += 20;

      doc.text('Bill To:', 20, y);
      y += 8;
      doc.text(clientName, 20, y);
      y += 8;
      const clientLines = doc.splitTextToSize(clientAddress, 170);
      doc.text(clientLines, 20, y);
      y += clientLines.length * 5 + 20;

      // Table
      doc.setFontSize(12);
      doc.text('Description', 20, y);
      doc.text('Qty', 105, y);
      doc.text('Rate', 135, y);
      doc.text('Total', 175, y);
      y += 8;
      doc.line(20, y, 195, y);
      y += 5;

      let subtotal = 0;
      document.querySelectorAll('#itemsContainer > div').forEach(row => {
        const desc = row.querySelector('.desc').value;
        if (desc) {
          const qty = parseFloat(row.querySelector('.qty').value) || 0;
          const rate = parseFloat(row.querySelector('.rate').value) || 0;
          const total = qty * rate;
          subtotal += total;
          const descLines = doc.splitTextToSize(desc, 80);
          doc.text(descLines, 20, y);
          doc.text(qty.toFixed(0), 110, y);
          doc.text(`$${rate.toFixed(2)}`, 140, y);
          doc.text(`$${total.toFixed(2)}`, 180, y);
          y += Math.max(1, descLines.length) * 6;
        }
      });

      y += 5;
      doc.line(20, y, 195, y);
      y += 10;
      doc.text(`Subtotal: $${subtotal.toFixed(2)}`, 140, y);
      y += 8;
      const taxRate = parseFloat(document.getElementById('taxRate').value) / 100 || 0;
      const tax = subtotal * taxRate;
      doc.text(`Tax: $${tax.toFixed(2)}`, 140, y);
      y += 8;
      const discRate = parseFloat(document.getElementById('discount').value) / 100 || 0;
      const disc = subtotal * discRate;
      doc.text(`Discount: -$${disc.toFixed(2)}`, 140, y);
      y += 15;
      const grandTotal = subtotal + tax - disc;
      doc.setFontSize(18);
      doc.setFont('helvetica', 'bold');
      doc.text(`TOTAL: $${grandTotal.toFixed(2)}`, 140, y);

      y = 270;
      doc.setFontSize(14);
      doc.text('Thank you for your business!', 20, y);

      doc.save(`invoice_${invoiceNum || '001'}.pdf`);
      // Feedback
      const btn = event.target;
      btn.textContent = 'âœ… PDF Downloaded!';
      btn.classList.add('animate-bounce');
      setTimeout(() => {
        btn.textContent = 'ğŸ“„ Generate & Download PDF Invoice';
        btn.classList.remove('animate-bounce');
      }, 2000);
    }

    // Event listeners for live updates
    document.addEventListener('input', e => {
      if (e.target.matches('#taxRate, #discount, .qty, .rate')) updateTotals();
    });
  </script>
</body>
</html>